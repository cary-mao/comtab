var comtab=function(i){if(!i)throw new Error("[comtab]: comtab.js require jquery.js");if(!i.ui)throw new Error("[comtab]: comTab.js require jquery-ui.js");var a=function(t){var e,n=t+"-pane",t=t+"-tab",i=p({PANE:n,PANE_HANDLE:n+"_handle",TAB:t,TAB_HEADER:t+"_header",TAB_CONTENT:t+"_content",TAB_BTN:t+"_btn"});for(e in i)i[e+"_ACTIVE"]=i[e]+"-active";return i}("comtab"),e=i("body"),n=p(null),o=null;function s(t,e){this.tabs=t,this._normalizeOptions(e),this._init()}function r(t,e,n){return e.addClass(a.TAB_CONTENT),t.addClass(a.TAB_BTN),p({btn:t,content:e,_actived:!!n})}function p(t){var e={};if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]={value:t[n],writable:!0,configurable:!0,enumerable:!0});return Object.create(null,e)}return e.droppable({drop:function(t,e){o.type===a.TAB_BTN&&(o.pane.removeTab(o.tab),setTimeout(function(){s.createPaneByDomMap(o.pane._tplPaneMap,[o.tab._tpl]).setPosition(e.offset).mount()}))}}),s.prototype={mount:function(){return e.append(this._pane),this},removeTab:function(t){this.tabs.splice(this.tabs.indexOf(t),1),t.content.remove(),t.btn.remove()},setPosition:function(t){return this._pane.css({position:"absolute",left:t.left+"px",top:t.top+"px"}),this},setRestrictSize:function(t){this._minWidth=t.minWidth||this._minWidth,this._minHeight=t.minHeight||this._minHeight,this._maxWidth=t.maxWidth||this._maxWidth,this._maxHeight=t.maxHeight||this._maxHeight,this._resizable.resizable("option","minWidth",this._minWidth).resizable("option","minHeight",this._minHeight).resizable("option","maxWidth",this._maxWidth).resizable("option","maxHeight",this._maxHeight)},setSize:function(t,e){return this._pane.css({width:t,height:e}),this},_init:function(){var e=this,t=this._createPaneDomMap(),n=null;this._pane=t.pane,this._paneHandle=t.paneHandle,this._tabHeader=t.tabHeader,this.tabs.forEach(function(t){e._appendTab(t),e._initTabEvent(t),n&&t.actived?e._deactiveTab(t):t._actived&&e._activeTab(n=t)}),n||this._activeTab(n=this.tabs[0]),this._initPaneEvent(),this._initRestrictSize(),this._mapDom()},_activeTab:function(t){t.actived=!0,t.btn.addClass(a.TAB_BTN_ACTIVE),t.content.addClass(a.TAB_CONTENT_ACTIVE)},_deactiveTab:function(t){t.actived=!1,t.btn.removeClass(a.TAB_BTN_ACTIVE),t.content.removeClass(a.TAB_CONTENT_ACTIVE)},_initRestrictSize:function(){this.setRestrictSize(this._options)},_mapDom:function(){var t=(new Date).getTime().toString();(n[t]=this)._pane.data("pane-id",t),this.id=t},_initTabEvent:function(n){var i=this;n._draggable=n.btn.draggable({appendTo:"body",helper:function(t,e){return n._tpl=i._cloneTab(n),i._tplPaneMap=i._clonePaneDomMap(n._tpl),i._activeTab(n._tpl),o=p({pane:i,tab:n,type:a.TAB_BTN}),i._tplPaneMap.pane}})},_initPaneEvent:function(){var t=this;this._draggable=this._pane.draggable({appendTo:e,handle:this._paneHandle,start:function(){o=p({type:a.PANE})}}),this._resizable=this._pane.resizable({containment:e,handles:"n, e, s, w, ne, se, sw, nw"}),this._listeners={paneSelect:function(){t.zIndex}},this._pane.on("mousedown",this._listeners.paneSelect)},_clonePaneDomMap:function(t){var e=this._createPaneDomMap();return this._appendTab.call({_pane:e.pane,_paneHandle:e.paneHandle,_tabHeader:e.tabHeader},t),e},_cloneTab:function(t){return r(t.btn.clone(),t.content.clone())},_appendTab:function(t){this._pane.append(t.content),this._tabHeader.append(t.btn)},_normalizeOptions:function(t){var e=p({minWidth:100,minHeight:60});this._options=Object.assign(e,t)},_createPaneDomMap:function(){var t=i('<div class="'+a.PANE+'"></div>'),e=i('<div class="'+a.PANE_HANDLE+'"></div>'),n=i('<div class="'+a.TAB_HEADER+'"></div>');return t.append(e).append(n),p({pane:t,paneHandle:e,tabHeader:n})}},s.createPaneByDomMap=function(t,e){var n=function(){};n.prototype=s.prototype,n.prototype.constructor=s;n=new n;return n._createPaneDomMap=function(){return t},s.call(n,e),delete n._createPaneDomMap,n},{createPane:function(t){return new s(t)},createTab:r}}(window.$||window.jQurey);